$(function(){$.cookie("search_conditions",null),$(".search_form").find("input[type=hidden]").each(function(){var e=$(this).prop("name"),t=$(this).val();if(null==$.cookie("search_conditions")){(o={})[e]=t,$.cookie("search_conditions",JSON.stringify(o))}else{if(null==(o=JSON.parse($.cookie("search_conditions"))))var o={};o[e]=t,$.cookie("search_conditions",JSON.stringify(o))}});for(var e=0;e<shopdata.text.scm_category[0].length;e++)$(".scm_category select").append('<option value="'+shopdata.text.scm_category[1][e]+'">'+shopdata.text.scm_category[0][e]+"</option>");$(".scm_search option").each(function(){$(this).val()==$(".search_form").find("input[name=search_type]").val()&&$(this).prop("selected",!0)}),$(".scm_category option").each(function(){$(this).val()==$(".search_form").find("input[name=scm_category]").val()&&$(this).prop("selected",!0)}),$(".scm_poststatus option").each(function(){$(this).val()==$(".search_form").find("input[name=scm_poststatus]").val()&&$(this).prop("selected",!0)}),$(".scm_search select").change(function(){$(".scm_search select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=search_type]").val($(this).val())})}),$(".scm_category select").change(function(){$(".scm_category select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=scm_category]").val($(this).val())})}),$(".scm_poststatus select").change(function(){$(".scm_poststatus select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=scm_poststatus]").val($(this).val())})}),$("#pagination").pagination({items:$(".search_form").find("input[name=total_page]").val(),itemsOnPage:1,edges:1,currentPage:Number($(".search_form").find("input[name=skip_page]").val())+1,cssStyle:"light-theme",onPageClick:function(e,t){var o=JSON.parse($.cookie("search_conditions"));$.each(o,function(e,t){$(".search_form").find("input[name="+e+"]").val(t)}),$(".search_form").find("input[name=skip_page]").val(e-1),$(".search_form").submit()}}),$(".scm_detail").on("click",function(){$(".panel_form form").hasClass("select_case")&&($(".panel_form form.select_case").length>1?(alert("一次只能查看一個商品的詳情！"),$(".panel_form form").removeClass("select_case")):$(".panel_form form.select_case").submit())}),$(".scl_search").on("click",function(){$(".search_form").find("input[name=skip_page]").val(0),$(".search_form").submit()}),$(".scm_status").on("click",function(){$(".panel_form form").hasClass("select_case")?($(".sdmr_body").fadeIn(400),$(".sdmr_body .btn_no").on("click",function(){$(".sdmr_body").fadeOut(400)}),$(".sdmr_body .btn_yes").on("click",function(){$(".sdmr_body").fadeOut(400);var e=$(".sdmr_body textarea").val(),t=[],o=[],s="";$(".panel_form form").each(function(){if($(this).hasClass("select_case")){var e=$(this).find("input[name=sd_id]").val(),s=$(this).find("input[name=scm_id]").val();t.push(e),o.push(s)}});s=0==$(".panel_form form.select_case").find("input[name=scm_poststatus]").val()?1:0;var a=$("input[name='_token']").val();$.ajax({url:"/shop/shopcoupondata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:a,scm_id:o,sd_id:t,status:s,sdmr_modifyreason:e,modify_type:1},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})})):alert("請選擇任何一個商品")}),$(".panel_form form").on("click",function(){$(this).hasClass("select_case")?$(this).removeClass("select_case"):$(this).addClass("select_case")}),$(".panel_form form").dblclick(function(){$(this).submit()}),$(".prompt_body_admin .btn_yes").on("click",function(){$(".prompt_body_admin").fadeOut(400),window.location="/shop/shopcoupondata-list"+document.location.search}),$(".prompt_body_admin .btn_no").on("click",function(){$(".prompt_body_admin").fadeOut(400),window.location="/shop/shopcoupondata-list"+document.location.search}),$(".prompt_body .btn_yes").on("click",function(){$(".prompt_body").fadeOut(400),$(".prompt_body").remove()})});