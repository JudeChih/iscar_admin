$(function(){$.cookie("search_conditions",null),$(".search_form").find("input[type=hidden]").each(function(){var e=$(this).prop("name"),t=$(this).val();if(null==$.cookie("search_conditions")){(o={})[e]=t,$.cookie("search_conditions",JSON.stringify(o))}else{if(null==(o=JSON.parse($.cookie("search_conditions"))))var o={};o[e]=t,$.cookie("search_conditions",JSON.stringify(o))}}),$(".sd_search option").each(function(){$(this).val()==$(".search_form").find("input[name=search_type]").val()&&$(this).prop("selected",!0)}),$(".sd_activestatus option").each(function(){$(this).val()==$(".search_form").find("input[name=sd_activestatus]").val()&&$(this).prop("selected",!0)}),$(".sd_havebind option").each(function(){$(this).val()==$(".search_form").find("input[name=sd_havebind]").val()&&$(this).prop("selected",!0)});for(var e=0;e<shopdata.text.sd_type_text.length;e++)$(".sd_type select").append('<option value="'+shopdata.sd_type[shopdata.text.sd_type_text[e]]+'">'+shopdata.text.sd_type_text[e]+"</option>");$(".sd_type select option").each(function(){$(".search_form").find("input[name=sd_type]").val()==$(this).val()&&$(this).prop("selected",!0)}),function(){for(a=0;a<shopdata.countries.length;a++)$(".sd_countries select").append("<option>"+shopdata.countries[a]+"</option>");if(0!=$(".search_form").find("input[name=sd_zipcode]").val()){for(var e="",t="",o=$(".search_form").find("input[name=sd_zipcode]").val(),a=0;a<shopdata.countries.length;a++)for(var n=0;n<shopdata.region[shopdata.countries[a]][1].length;n++)shopdata.region[shopdata.countries[a]][1][n]==o&&(e=shopdata.countries[a],t=shopdata.region[shopdata.countries[a]][0][n]);for($(".sd_countries select option").each(function(){$(this).text()==e&&$(this).prop("selected",!0)}),a=0;a<shopdata.region[e][0].length;a++)$(".sd_region select").append('<option value="'+shopdata.region[e][1][a]+'">'+shopdata.region[e][0][a]+"</option>");$(".sd_region select option").each(function(){$(this).text()==t&&$(this).prop("selected",!0)})}else for(e="",$(".sd_countries select option").each(function(){$(this).prop("selected")&&(e=$(this).text())}),a=0;a<shopdata.region[e][0].length;a++)$(".sd_region select").append('<option value="'+shopdata.region[e][1][a]+'">'+shopdata.region[e][0][a]+"</option>")}(),$(".sd_type select").change(function(){$(".sd_type select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=sd_type]").val($(this).val())})}),$(".sd_activestatus select").change(function(){$(".sd_activestatus select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=sd_activestatus]").val($(this).val())})}),$(".sd_havebind select").change(function(){$(".sd_havebind select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=sd_havebind]").val($(this).val())})}),$(".sd_countries select").change(function(){!function(){var t="";for($(".sd_countries select option").each(function(){$(this).prop("selected")&&(t=$(this).text())}),$(".sd_region select option").remove(),e=0;e<shopdata.region[t][0].length;e++)$(".sd_region select").append('<option value="'+shopdata.region[t][1][e]+'">'+shopdata.region[t][0][e]+"</option>");$(".search_form").find("input[name=sd_zipcode]").val(shopdata.region[t][1][0])}()}),$(".sd_region select").change(function(){$(".sd_region select option").each(function(){$(this).prop("selected")&&$(".search_form").find("input[name=sd_zipcode]").val($(this).val())})}),$(".sd_zipcode_turnText").each(function(){for(var e=$(this).text(),t="",o="",a=0;a<shopdata.countries.length;a++)for(var n=0;n<shopdata.region[shopdata.countries[a]][1].length;n++)shopdata.region[shopdata.countries[a]][1][n]==e&&(t=shopdata.countries[a],o=shopdata.region[shopdata.countries[a]][0][n]);""!=t&&""!=o&&$(this).text(t+" "+o)}),$("#pagination").pagination({items:$(".search_form").find("input[name=total_page]").val(),itemsOnPage:1,edges:1,currentPage:Number($(".search_form").find("input[name=skip_page]").val())+1,cssStyle:"light-theme",onPageClick:function(e,t){var o=JSON.parse($.cookie("search_conditions"));$.each(o,function(e,t){$(".search_form").find("input[name="+e+"]").val(t)}),$(".search_form").find("input[name=skip_page]").val(e-1),$(".search_form").submit()}}),$(".sdl_payment").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能設置一家汽車特店！"),$(".panel_form form").removeClass("select_case")):($(".sdmr_body").fadeIn(400),$(".sdmr_body .btn_no").on("click",function(){$(".sdmr_body").fadeOut(400)}),$(".sdmr_body .btn_yes").on("click",function(){$(".sdmr_body").fadeOut(400);var e=$(".sdmr_body textarea").val(),t="",o="";o=0==(o=$(".panel_form form.select_case").find("input[name=sd_paymentflowagreement]").val())||2==o?1:2,t=$(".panel_form form.select_case").find("input[name=sd_id]").val();var a=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:a,sd_id:t,sd_paymentflowagreement:o,sdmr_modifyreason:e,modify_type:6},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})})):setTipBox("請選擇任何一家汽車特店")}),$(".sdl_metatag").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能設置一家汽車特店！"),$(".panel_form form").removeClass("select_case")):($(".metatag_body").fadeIn(400),$(".metatag_body .btn_no").on("click",function(){$(".metatag_body").fadeOut(400),$(".metatag_body textarea").val("")}),$(".metatag_body .btn_yes").on("click",function(){$(".metatag_body").fadeOut(400);var e=$(".metatag_body textarea[name=sd_seo_keywords]").val(),t=$(".metatag_body textarea[name=sd_seo_description]").val(),o=$(".metatag_body textarea[name=sd_seo_title]").val();if(t.length>125)setTipBox("特店描述字數限制125個字！"),$(".metatag_body textarea").val("");else if(e.length>125)setTipBox("關鍵字字數限制125個字！"),$(".metatag_body textarea").val("");else if(o.length>50)setTipBox("標題字數限制50個字！"),$(".metatag_body textarea").val("");else{var a="";a=$(".panel_form form.select_case").find("input[name=sd_id]").val();var n=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:n,sd_id:a,sd_seo_keywords:e,sd_seo_description:t,sd_seo_title:o,modify_type:5},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})}})):setTipBox("請選擇任何一家汽車特店！")}),$(".sdl_detail").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能查看一家汽車特店的詳情！"),$(".panel_form form").removeClass("select_case")):$(".panel_form form.select_case").submit():setTipBox("請選擇任何一家汽車特店！")}),$(".sdl_salescode").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能設置一家汽車特店！"),$(".panel_form form").removeClass("select_case")):($(".sd_body").fadeIn(400),$(".sd_body .btn_no").on("click",function(){$(".sd_body").fadeOut(400),$(".sd_body input").val("")}),$(".sd_body .btn_yes").on("click",function(){$(".sd_body").fadeOut(400);var e=$(".sd_body input").val();if(7!=e.length)setTipBox("代號必須為7碼，英數夾雜！"),$(".sd_body input").val("");else{var t="";t=$(".panel_form form.select_case").find("input[name=sd_id]").val();var o=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:o,sd_id:t,sd_salescode:e,modify_type:4},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})}})):setTipBox("請選擇任何一家汽車特店！")}),$(".sdl_search").on("click",function(){$(".search_form").find("input[name=skip_page]").val(0),$(".search_form").submit()}),$(".sdl_havebind").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能設置一家汽車特店！"),$(".panel_form form").removeClass("select_case")):($(".sdmr_body").fadeIn(400),$(".sdmr_body .btn_no").on("click",function(){$(".sdmr_body").fadeOut(400),$(".sdmr_body textarea").val("")}),$(".sdmr_body .btn_yes").on("click",function(){$(".sdmr_body").fadeOut(400);var e=$(".sdmr_body textarea").val(),t="";t=$(".panel_form form.select_case").find("input[name=sd_id]").val();var o=$(".panel_form form.select_case").find("input[name=sd_havebind]").val();o=0==o?1:0;var a=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:a,sd_id:t,sdmr_modifyreason:e,have_bind:o,modify_type:3},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})})):setTipBox("請選擇任何一家汽車特店！")}),$(".sdl_status").on("click",function(){$(".panel_form form").hasClass("select_case")?($(".sdmr_body").fadeIn(400),$(".sdmr_body .btn_no").on("click",function(){$(".sdmr_body").fadeOut(400),$(".sdmr_body textarea").val("")}),$(".sdmr_body .btn_yes").on("click",function(){$(".sdmr_body").fadeOut(400);var e=$(".sdmr_body textarea").val(),t=[],o="";$(".panel_form form").each(function(){if($(this).hasClass("select_case")){var e=$(this).find("input[name=sd_id]").val();t.push(e)}});o=0==$(".panel_form form.select_case").find("input[name=sd_activestatus]").val()?1:0;var a=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:a,sd_id:t,sdmr_modifyreason:e,status:o,modify_type:1},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})})):setTipBox("請選擇任何一家汽車特店！")}),$(".sdl_flag").on("click",function(){$(".panel_form form").hasClass("select_case")?$(".panel_form form.select_case").length>1?(setTipBox("一次只能刪除一家汽車特店！"),$(".panel_form form").removeClass("select_case")):($(".sdmr_body").fadeIn(400),$(".sdmr_body .btn_no").on("click",function(){$(".sdmr_body").fadeOut(400)}),$(".sdmr_body .btn_yes").on("click",function(){$(".sdmr_body").fadeOut(400);var e=$(".sdmr_body textarea").val(),t="";t=$(".panel_form form.select_case").find("input[name=sd_id]").val();var o=$("input[name='_token']").val();$.ajax({url:"/shop/shopdata/modify",type:"POST",cache:!1,datatype:"json",data:{_token:o,sd_id:t,sdmr_modifyreason:e,modify_type:2},beforeSend:function(e){e.setRequestHeader("X-CSRF-TOKEN",$("#token").attr("content"))},success:function(e){$(".prompt_body_admin h2").text(e),$(".prompt_body_admin").fadeIn(400)},error:function(){console.log("error")}})})):setTipBox("請選擇任何一家汽車特店")}),$(".panel_form form").on("click",function(){$(this).hasClass("select_case")?$(this).removeClass("select_case"):$(this).addClass("select_case")}),$(".panel_form form").dblclick(function(){$(this).submit()}),$(".prompt_body_admin .btn_yes").on("click",function(){$(".prompt_body_admin").fadeOut(400),window.location="/shop/shopdata-list"+document.location.search}),$(".prompt_body_admin .btn_no").on("click",function(){$(".prompt_body_admin").fadeOut(400),window.location="/shop/shopdata-list"+document.location.search}),$(".prompt_body .btn_yes").on("click",function(){$(".prompt_body").fadeOut(400),$(".prompt_body").remove()}),setTipBox=function(e){e='<div class="prompt_body_admin tip_box"><div class="prompt_box_admin panel-primary"><div class="panel-heading"><h3>提示框</h3></div><h2>'+e+'</h2><div><button type="button" class="btn btn-success cancel">確認</button></div></div></div>';$("body").append(e),$(".tip_box").fadeIn(400),$(".prompt_body_admin .cancel").on("click",function(){$(".tip_box").fadeOut(400),$(".tip_box").remove()})}});